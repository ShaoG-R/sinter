# Sinter UI

Sinter UI æ˜¯ä¸€ä¸ªç”¨äºæ„å»º Web åº”ç”¨ç¨‹åºçš„ä¸‹ä¸€ä»£ Rust åº“ã€‚å®ƒæ·±å— **SolidJS** çš„ç»†ç²’åº¦å“åº”å¼è®¾è®¡å¯å‘ï¼Œä½†ä¸“ä¸º Rust è¯­è¨€ç‰¹æ€§è¿›è¡Œäº†ä¼˜åŒ–ã€‚å®ƒæ‘’å¼ƒäº†è™šæ‹Ÿ DOM (VDOM)ï¼Œé€šè¿‡ä¿¡å· (Signal) å’Œå‰¯ä½œç”¨ (Effect) ç›´æ¥é©±åŠ¨çœŸå® DOM çš„æ›´æ–°ï¼Œä»è€Œå®ç°æè‡´çš„æ€§èƒ½ã€‚

Sinter UI çš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯ **"Rusty & Fluent"** â€”â€” æä¾›ä¸€å¥—ç¬¦åˆ Rust ç¼–ç¨‹ä¹ æƒ¯çš„ã€ç±»å‹å®‰å…¨çš„ã€åŸºäºæ„å»ºè€…æ¨¡å¼ (Builder Pattern) çš„ APIï¼Œè€Œä¸æ˜¯è¿‡åº¦ä¾èµ–å®æˆ–ä¸ºäº†æ¨¡ä»¿ JSX è€Œç‰ºç‰² Rust çš„å¼ºç±»å‹ä¼˜åŠ¿ã€‚

## ğŸŒŸ æ ¸å¿ƒè®¾è®¡æ€è·¯ (Design Philosophy)

### 1. æ— è™šæ‹Ÿ DOM (No VDOM) & ç»†ç²’åº¦å“åº”å¼
Sinter UI ä¸ä½¿ç”¨è™šæ‹Ÿ DOM Diff ç®—æ³•ã€‚ç›¸åï¼Œå®ƒé‡‡ç”¨ç»†ç²’åº¦çš„å“åº”å¼ç³»ç»Ÿã€‚
- **å³æ—¶æ›´æ–°**ï¼šå½“çŠ¶æ€ (Signal) å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªæœ‰ä¾èµ–è¯¥çŠ¶æ€çš„å…·ä½“ DOM å±æ€§æˆ–æ–‡æœ¬èŠ‚ç‚¹ä¼šæ›´æ–°ï¼Œä¸ä¼šæœ‰ç»„ä»¶çº§çš„é‡æ¸²æŸ“å¼€é”€ã€‚
- **ç²¾ç¡®ä¾èµ–è¿½è¸ª**ï¼šç³»ç»Ÿè‡ªåŠ¨æ”¶é›†ä¾èµ–å…³ç³»ï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨å£°æ˜ä¾èµ–æ•°ç»„ã€‚

### 2. æµå¼æ„å»ºè€… API (Fluent Builder API)
Sinter UI æå€¡ä½¿ç”¨**æ„å»ºè€…æ¨¡å¼**æ¥ç»„è£… UIï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç±»ä¼¼ JSX çš„å®ã€‚
- **ç±»å‹å®‰å…¨**ï¼šæ‰€æœ‰å±æ€§ã€æ ·å¼å’Œäº‹ä»¶ç»‘å®šéƒ½æ˜¯ç±»å‹æ£€æŸ¥çš„ã€‚
- **IDE å‹å¥½**ï¼šåˆ©ç”¨ Rust å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿï¼Œæä¾›ä¼˜ç§€çš„ä»£ç è¡¥å…¨å’Œé‡æ„ä½“éªŒã€‚
- **ç»„åˆä¼˜äºç»§æ‰¿**ï¼šç»„ä»¶ä»…ä»…æ˜¯å®ç°äº† `View` ç‰¹å¾çš„ç»“æ„ä½“æˆ–å‡½æ•°ï¼Œæ˜“äºç»„åˆã€‚

```rust
// ç¤ºä¾‹ï¼šæµå¼ API
div()
    .class("container")
    .style("display: flex")
    .child(
        button()
            .on_click(|| println!("Clicked!"))
            .text("Click Me")
    )
```

### 3. å¤šæ€å±æ€§ä¸è§†å›¾ (Polymorphic Attributes & Views)
Sinter UI å……åˆ†åˆ©ç”¨ Rust çš„ Trait ç³»ç»Ÿï¼Œä½¿å¾— API æå…·çµæ´»æ€§ï¼š
- **å±æ€§å¤šæ€**ï¼š`attr`ã€`id` ç­‰æ–¹æ³•ä¸ä»…æ¥å—é™æ€å­—ç¬¦ä¸²ï¼Œè¿˜æ¥å— `Signal`ã€é—­åŒ…ç­‰ã€‚å¦‚æœæ˜¯å“åº”å¼æ•°æ®ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨å»ºç«‹ç»‘å®šã€‚
- **è§†å›¾å¤šæ€**ï¼š`View` ç‰¹å¾å®ç°äº†å¯¹åŸºç¡€ç±»å‹ï¼ˆæ•°å­—ã€å¸ƒå°”ï¼‰ã€å­—ç¬¦ä¸²ã€å…ƒç»„ï¼ˆç”¨äºç‰‡æ®µï¼‰ã€`Option`ã€`Vec` ç­‰çš„å¹¿æ³›æ”¯æŒï¼Œä½¿å¾— UI ç»“æ„å®šä¹‰éå¸¸è‡ªç„¶ã€‚

## ğŸ—ï¸ è®¾è®¡æ¶æ„ä¸å®ç° (Architecture & Implementation)

Sinter UI çš„æ¶æ„ä¸»è¦ç”±ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ç»„æˆï¼š**Reactivity (å“åº”å¼æ ¸å¿ƒ)**ã€**DOM (è§†å›¾å±‚)** å’Œ **Flow (æ§åˆ¶æµ)**ã€‚

### 1. å“åº”å¼æ ¸å¿ƒ (`src/reactivity`)
è¿™æ˜¯é©±åŠ¨æ•´ä¸ªæ¡†æ¶çš„å¼•æ“ï¼Œä½äº `sinter_ui/src/reactivity.rs` å’Œ `runtime.rs`ã€‚

- **Runtime (è¿è¡Œæ—¶)**ï¼šä½¿ç”¨ `SlotMap` å’Œ `RefCell` å­˜å‚¨æ‰€æœ‰çš„å“åº”å¼èŠ‚ç‚¹ï¼ˆSignal, Effect, Scopeï¼‰ã€‚è¿™ç¡®ä¿äº†èŠ‚ç‚¹å¼•ç”¨çš„ç¨³å®šæ€§ï¼ˆé€šè¿‡ `NodeId`ï¼‰ä¸”é¿å…äº†å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸå¼•ç”¨åœ°ç‹±ã€‚
- **Dependency Graph (ä¾èµ–å›¾)**ï¼š
    - `subscribers`: è®°å½• Signal -> Effects çš„æ˜ å°„ï¼ˆå½“ Signal å˜æ—¶é€šçŸ¥è°ï¼‰ã€‚
    - `dependencies`: è®°å½• Effect -> Signals çš„æ˜ å°„ï¼ˆç”¨äºæ¸…ç†æ—§ä¾èµ–ï¼‰ã€‚
- **Scope System (ä½œç”¨åŸŸç³»ç»Ÿ)**ï¼š
    - ä½¿ç”¨ `Scope` æ¥ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚å½“ä¸€ä¸ª Scope è¢«é”€æ¯æ—¶ï¼Œå…¶ä¸‹çš„æ‰€æœ‰ Effectã€å­ Scope å’Œæ³¨å†Œçš„ cleanup å›è°ƒï¼ˆ`on_cleanup`ï¼‰éƒ½ä¼šè¢«è‡ªåŠ¨æ¸…ç†ï¼Œæœ‰æ•ˆé˜²æ­¢å†…å­˜æ³„æ¼ã€‚
- **Primitives (åŸè¯­)**ï¼š
    - `create_signal`: åˆ›å»ºè¯»å†™ä¿¡å·å¯¹ã€‚
    - `create_effect`: åˆ›å»ºå‰¯ä½œç”¨ï¼Œè‡ªåŠ¨è¿½è¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­è®¿é—®çš„ä¿¡å·ã€‚
    - `create_memo`: åˆ›å»ºè®¡ç®—ç¼“å­˜ä¿¡å·ã€‚
    - `create_resource`: é›†æˆ `Future`ï¼Œç”¨äºå¼‚æ­¥æ•°æ®åŠ è½½ã€‚

### 2. DOM æŠ½è±¡å±‚ (`src/dom`)
è¿™ä¸€å±‚è¿æ¥å“åº”å¼ç³»ç»Ÿä¸æµè§ˆå™¨çš„ `web-sys` APIã€‚

- **Element (`dom/element.rs`)**ï¼š
    - å¯¹ `web_sys::Element` çš„è½»é‡çº§åŒ…è£…ã€‚
    - æä¾›äº† `.attr()`, `.style()`, `.on_click()` ç­‰é“¾å¼æ–¹æ³•ã€‚
    - **æ™ºèƒ½ç»‘å®š**ï¼šä¾‹å¦‚ `attr` æ–¹æ³•æ¥æ”¶ `impl AttributeValue`ã€‚å¦‚æœä¼ å…¥çš„æ˜¯ `ReadSignal`ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå†…éƒ¨ Effect æ¥ä¿æŒ DOM å±æ€§ä¸ Signal åŒæ­¥ï¼›å¦‚æœä¼ å…¥çš„æ˜¯é™æ€å€¼ï¼Œåˆ™åªè®¾ç½®ä¸€æ¬¡ã€‚
- **View Trait (`dom/view.rs`)**ï¼š
    - å®šä¹‰äº† `mount(self, parent: &Node)` æ–¹æ³•ã€‚
    - å®ç°äº†å¯¹ Rust åŸç”Ÿç±»å‹ã€é›†åˆç±»å‹å’Œé—­åŒ…çš„æ¸²æŸ“æ”¯æŒã€‚
    - é—­åŒ…ä½œä¸º View æ—¶ï¼ˆ`Fn() -> impl View`ï¼‰ï¼Œè¢«è§†ä¸º"æƒ°æ€§è§†å›¾"ï¼Œç»“åˆ `create_effect` å¯å®ç°åŠ¨æ€æ–‡æœ¬æ›´æ–°ã€‚
- **Suspense (`dom/suspense.rs`)**ï¼š
    - ç»“åˆ `SuspenseContext`ï¼Œé€šè¿‡ç›‘æ§å¼‚æ­¥ä»»åŠ¡è®¡æ•°å™¨ï¼Œåœ¨æ•°æ®åŠ è½½æ—¶è‡ªåŠ¨åˆ‡æ¢æ˜¾ç¤º `fallback` è§†å›¾å’Œå®é™… `children` è§†å›¾ã€‚

### 3. æ§åˆ¶æµç»„ä»¶ (`src/flow`)
Sinter UI ä¸ä½¿ç”¨ç¼–è¯‘å™¨é­”æ³•å¤„ç† `if` æˆ– `for`ï¼Œè€Œæ˜¯æä¾›é«˜æ•ˆçš„ç»„ä»¶ã€‚

- **Show (`flow/show.rs`)**ï¼š
    - æ¡ä»¶æ¸²æŸ“ç»„ä»¶ã€‚
    - æä¾›äº† `.when(condition).otherwise(fallback)` çš„è¯­æ³•ç³–ã€‚
    - ä¼˜åŒ–ï¼šå½“æ¡ä»¶å˜åŒ–æ—¶ï¼ŒåªæŒ‚è½½/å¸è½½å¿…è¦çš„åˆ†æ”¯ã€‚
- **For (`flow/for_loop.rs`)**ï¼š
    - åˆ—è¡¨æ¸²æŸ“ç»„ä»¶ã€‚
    - **Keyed Diffing**ï¼šé€šè¿‡ `key` å‡½æ•°è¿½è¸ªåˆ—è¡¨é¡¹ã€‚å½“åˆ—è¡¨æ•°æ®å˜åŒ–æ—¶ï¼Œå®ƒä¼šå¯¹æ¯”æ–°æ—§ key é›†åˆï¼Œä»…å¯¹æ–°å¢ã€åˆ é™¤æˆ–ç§»åŠ¨çš„é¡¹è¿›è¡Œ DOM æ“ä½œï¼Œå¤ç”¨å·²æœ‰çš„ DOM èŠ‚ç‚¹å’Œ Scopeï¼Œæ€§èƒ½è¿œè¶…å…¨é‡é‡å»ºã€‚
- **Dynamic (`flow/dynamic.rs`)**ï¼š
    - é€šç”¨åŠ¨æ€ç»„ä»¶ï¼Œæ ¹æ®é—­åŒ…è¿”å›çš„ View ç±»å‹åŠ¨æ€åˆ‡æ¢å†…å®¹ã€‚

## ğŸ“ æ ¸å¿ƒæ¨¡å—æ¦‚è§ˆ

| æ¨¡å— | è·¯å¾„ | æè¿° |
|------|------|------|
| **Dom** | `dom/element.rs`, `dom/attribute.rs` | DOM å…ƒç´ å°è£…ã€å±æ€§ç»‘å®šé€»è¾‘ã€SVGæ”¯æŒã€‚ |
| **View** | `dom/view.rs` | `View` ç‰¹å¾å®šä¹‰åŠé’ˆå¯¹å„ç±» Rust ç±»å‹çš„å®ç°ã€‚ |
| **Reactivity** | `reactivity.rs`, `reactivity/runtime.rs` | ä¿¡å·ã€å‰¯ä½œç”¨ã€Scope ç®¡ç†ã€è¿è¡Œæ—¶çŠ¶æ€ã€‚ |
| **Flow** | `flow/show.rs`, `flow/for_loop.rs` | `Show` (if), `For` (loop) ç­‰æ§åˆ¶æµçš„é«˜æ•ˆå®ç°ã€‚ |
| **Suspense** | `dom/suspense.rs` | å¼‚æ­¥è¾¹ç•Œå¤„ç†ï¼Œæ”¯æŒ Loading çŠ¶æ€å›é€€ã€‚ |

## ğŸš€ ç¤ºä¾‹ä»£ç 

ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Props Builder æ¨¡å¼ã€Context API å’Œæ§åˆ¶æµç»„ä»¶æ¥æ„å»ºåº”ç”¨ï¼š

```rust
use sinter_ui::prelude::*;

fn main() {
    // åˆ›å»ºæ ¹ä½œç”¨åŸŸ
    create_scope(move || {
        let (count, set_count) = create_signal(0);

        div()
            .class("app")
            .child((
                h1().text("Sinter UI Counter"),
                
                // æ§åˆ¶æµ
                count.read_signal().when(move || {
                    span().text("Count is positive!")
                }),

                // äº¤äº’
                button()
                    .on_click(move || set_count.update(|n| *n += 1))
                    .text("Increment"),
                
                // åŠ¨æ€æ–‡æœ¬ç»‘å®š
                p().text(move || format!("Current count: {}", count.get().unwrap()))
            ))
            .mount(&document.body().unwrap());
    });
}
```

## ğŸ› ï¸ å½“å‰çŠ¶æ€

Sinter UI ç›®å‰å¤„äº **Alpha** é˜¶æ®µã€‚
- âœ… æ ¸å¿ƒå“åº”å¼ç³»ç»Ÿ (Signal, Effect, Memo, Scope)
- âœ… åŸºç¡€ DOM ç»‘å®š (Attr, Event, Style)
- âœ… æ ¸å¿ƒæ§åˆ¶æµ (Show, For, Dynamic)
- âœ… å¼‚æ­¥èµ„æºä¸ Suspense
- âœ… Context API
- ğŸš§ SSR (æœåŠ¡ç«¯æ¸²æŸ“) - å°šæœªå®ç°
- ğŸš§ Hydration - å°šæœªå®ç°
